!function(e){var s=function(){this.options={activeClass:"active",valueSource:"index",prePopulate:null,cssOptions:{vertical:!1,quadratic:!1,size:"medium",picker:null,element:null,hover:null,selected:null}},this.type="inline",this.input=null,this.selector=null,this.isPressed=!1,this.lastElem="",this.setEvendHandlers=function(){var e=this;this.items.click(function(){e.select.call(this,e,!1)}),this.items.mousemove(function(s){e.isPressed&&e.lastElem!==s.target&&(e.hover(s),e.lastElem=s.target)}),this.selector.mousedown(function(s){e.isPressed=!0}),this.selector.mouseleave(function(s){e.isPressed=!1}),this.items.mouseup(this.finishHover.bind(this))},this.hover=function(s){var t=e(s.target);this.select.call(t,this,!1)},this.finishHover=function(e){this.lastElem=null,this.isPressed=!1},this.select=function(t,i){var o;return o="index"===t.options.valueSource?e(this).index():"data-"===t.options.valueSource.substring(0,5)?e(this).attr(t.options.valueSource):"text"===t.options.valueSource?e(this).text():e(this).val(),t.options.isSingle?(t.clear(),e(this).siblings("."+t.options.activeClass).removeClass(),e(this).addClass(t.options.activeClass),void t.addValue(this,o)):void(e(this).hasClass(t.options.activeClass)?(e(this).removeClass(),t.removeValue(this,o),s.updateClasses(e(this),t.options.activeClass),t.options.onUnselect&&"function"==typeof t.options.onUnselect&&!i&&t.options.onUnselect(this,o)):(e(this).addClass(t.options.activeClass),t.addValue(this,o),s.updateClasses(e(this),t.options.activeClass),t.options.onSelect&&"function"==typeof t.options.onSelect&&!i&&t.options.onSelect(this,o)))},this.addValue=function(s,t){if("inline"===this.type){var i=this.input.val();i&&(i+=","),i+=t,this.input.val(i)}else this.selector.find("input[value='"+e(s).attr("data-value")+"']").attr("checked",!0)},this.removeValue=function(s,t){if("inline"===this.type){var i=this.input.val();i=i.replace(","+t,"").replace(t+",","").replace(t,""),this.input.val(i)}else this.selector.find("input[value='"+e(s).attr("data-value")+"']").attr("checked",!1)},this.clear=function(){"inline"===this.type?this.input.val(""):this.selector.find("input").attr("checked",!1)},this.prePopulate=function(){if(s.isArray(this.options.prePopulate)&&this.options.prePopulate.length)for(var t in this.options.prePopulate){var i=this.options.prePopulate[t],o=this.getPrepopulateSelector(i);e(o).index()<0?console.warn("Multipicker: prepopulated element doesn`t found `%s`",i):this.select.call(o,this,!0)}else{var o=this.getPrepopulateSelector(this.options.prePopulate);e(o).index()<0?console.warn("Multipicker: prepopulated element doesn`t found`%s`",this.options.prePopulate):this.select.call(o,this,!0)}},this.getPrepopulateSelector=function(e){return"index"!==this.options.valueSource&&this.options.valueSource?"data-"===this.options.valueSource.substring(0,5)?this.selector.find(this.options.selector+"["+this.options.valueSource+"='"+e+"']"):"text"===this.options.valueSource?this.selector.find(this.options.selector+":contains('"+e+"')"):void 0:this.items.eq(e)}};s.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)?!0:void 0},s.updateClasses=function(s,t){e(s).hasClass(t)?e(s).next().hasClass(t)&&e(s).prev().hasClass(t)?(e(s).next().next().hasClass(t)?(e(s).next().removeClass(),e(s).next().addClass(t+" center-side")):(e(s).next().removeClass(),e(s).next().addClass(t+" right-side")),e(s).prev().prev().hasClass(t)?(e(s).prev().removeClass(),e(s).prev().addClass(t+" center-side")):(e(s).prev().removeClass(),e(s).prev().addClass(t+" left-side")),e(s).removeClass(),e(s).addClass("active center-side")):e(s).next().hasClass(t)&&!e(s).prev().hasClass(t)?(e(s).next().next().hasClass(t)?(e(s).next().removeClass(),e(s).next().addClass(t+" center-side")):(e(s).next().removeClass(),e(s).next().addClass(t+" right-side")),e(s).removeClass(),e(s).addClass("active left-side")):!e(s).next().hasClass(t)&&e(s).prev().hasClass(t)&&(e(s).prev().prev().hasClass(t)?(e(s).prev().removeClass(),e(s).prev().addClass(t+" center-side")):(e(s).prev().removeClass(),e(s).prev().addClass(t+" left-side")),e(s).removeClass(),e(s).addClass(t+" right-side")):(e(s).next().hasClass("right-side")&&(e(s).next().removeClass(),e(s).next().addClass(t)),e(s).prev().hasClass("left-side")&&(e(s).prev().removeClass(),e(s).prev().addClass(t)),e(s).prev().hasClass("center-side")&&(e(s).prev().removeClass(),e(s).prev().addClass(t+" right-side")),e(s).next().hasClass("center-side")&&(e(s).next().removeClass(),e(s).next().addClass(t+" left-side")))},s.generateStyles=function(s,t){var i="";if(t.picker){i+="#"+s+".checklist {";for(var o in t.picker)i+=o+":"+t.picker[o]+";";i+="}"}if(t.element){i+="#"+s+" > * {";for(var o in t.element)i+=o+":"+t.element[o]+";";i+="}"}if(t.selected){i+="#"+s+" > *.active {";for(var o in t.selected)i+=o+":"+t.selected[o]+";";i+="}"}if(t.hover){i+="#"+s+" > *:hover {";for(var o in t.hover)i+=o+":"+t.hover[o]+";";i+="}"}e("head").append("<style type='text/css'>"+i+"</style>")},e.fn.extend({multiPicker:function(t){var i=new s;if(i.options=Object.assign(i.options,t),i.selector=e("#"+this.attr("id")),"checkbox"===i.options.selector||"radio"===i.options.selector?(i.type=i.options.selector,"radio"===i.type&&(i.options.isSingle=!0),i.selector.find("label").css("display","none"),e(i.selector).find("input").each(function(s,t){var o=e(t).val(),n=e("label[for='"+e(t).attr("id")+"']").text()||o;i.selector.append("<span data-value='"+o+"'>"+n+"</span>")}),i.items=i.selector.find("span"),i.options.valueSource="data-value",i.options.selector="span",i.options.cssOptions.vertical?i.selector.addClass("more-padded-t"):i.selector.addClass("more-padded-l")):("inline"===i.type&&(e("[name="+i.options.inputName+"]").length?i.input=e("[name="+i.options.inputName+"]"):(i.selector.after("<input type='hidden' name='"+i.options.inputName+"'>"),i.input=e("[name="+i.options.inputName+"]"))),i.items=i.selector.find(i.options.selector)),i.selector.addClass("checklist"),i.options.cssOptions.vertical&&i.selector.addClass("vertical"),i.options.cssOptions.size&&i.selector.addClass(i.options.cssOptions.size),i.options.cssOptions.quadratic&&i.selector.addClass("quadratic"),(i.options.cssOptions.picker||i.options.cssOptions.element||i.options.cssOptions.hover||i.options.cssOptions.selected)&&s.generateStyles(this.attr("id"),i.options.cssOptions),i.options.prePopulate&&s.isArray(i.options.prePopulate)&&i.options.prePopulate.length>1&&i.options.isSingle)throw"Can not prePopulate more then 1 item, with `isSingle` true option";if(i.options.valueSource&&"index"===i.options.valueSource&&"text"===i.options.valueSource&&"data-"!==i.options.valueSource.substring(0,5))throw"Invalid value source";i.options.prePopulate&&i.prePopulate(),i.selector.attr("ondragstart","return false"),i.setEvendHandlers(),i.options.onInit&&"function"==typeof i.options.onInit&&i.options.onInit()}})}(jQuery);
